--- a/glib/meson.build
+++ b/glib/meson.build
@@ -400,8 +400,9 @@ endif
 
 pcre2_static_args = []
 
-if use_pcre2_static_flag
+if pcre2.type_name() == 'internal'
   pcre2_static_args = ['-DPCRE2_STATIC']
+  pcre2 = pcre2.as_link_whole()
 endif
 
 glib_c_args = ['-DG_LOG_DOMAIN="GLib"'] + glib_c_args_internal + pcre2_static_args
